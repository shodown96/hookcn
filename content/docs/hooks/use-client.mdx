---
title: useClient
description: A simple and consistent hook for making API requests in your application.
---

## Installation

<Tabs defaultValue="cli">

<TabsList>
  <TabsTrigger value="cli">CLI</TabsTrigger>
  <TabsTrigger value="manual">Manual</TabsTrigger>
</TabsList>

<TabsContent value="cli">

```bash
npx shadcn@latest add https://hookcn.ouassim.tech/r/use-client
```

</TabsContent>

<TabsContent value="manual">

<Steps>

<Step>Copy and paste the following code into your project.</Step>

<ComponentSource name="use-client" />

</Steps>

</TabsContent>

</Tabs>

## Usage

```tsx {4, 7}
import { useFormik } from "formik"

// zod schema definitions
import { SignInParamsSchema, SignInParamsType } from "@/lib/validations/auth"
import { useClient } from "@/hooks/use-client"

export default function SignInPage() {
  const { callApi } = useClient()

  const handleFormSubmit = async (values: SignInParamsType) => {
    try {
      const result = await callApi({
        method: "POST",
        url: "http:/localhost:4000/api/auth/sign-in",
        payload: values,
      })

      if (result?.status === 200) {
        // Toast message
        // Route to another page
      } else {
        // Toast message
      }
    } catch (error) {
      // Toast message
    }
  }

  const formik = useFormik<SignInParamsType>({
    initialValues: {
      email: "",
      password: "",
    },
    validationSchema: SignInParamsSchema,
    validateOnBlur: true,
    onSubmit: handleFormSubmit,
  })

  const { handleChange, handleBlur, handleSubmit, isSubmitting, isValid } =
    formik

  return (
    <div className="">
      <div className="font-medium text-xl">Sign in</div>
      <form onSubmit={handleSubmit} className="flex flex-col gap-4">
        <input
          id="email"
          onBlur={handleBlur}
          onChange={handleChange}
          type="email"
        />
        <input
          id="password"
          type="password"
          onBlur={handleBlur}
          onChange={handleChange}
        />
        <a
          href={"/auth/forgot-password"}
          className={"text-sm text-tertiary underline cursor-pointer"}
        >
          Forgot Password?
        </a>
        <button type="submit" disabled={!isValid || isSubmitting}>
          {isSubmitting ? "Loading" : "Sign In"}
        </button>
      </form>
    </div>
  )
}
```

## Customization tips

The hook can be customized to connect with state managemnt stores like zustand, redux, etc to ensure requests are sent with tokens

```typescript
// @/hooks/use-client.tsx"

  ...
  const { tokens } = useAuthStore()
  const [data, setData] = useState(null);
  ...
  const headers = {
      'Content-Type': multipart ? 'multipart/form-data' : 'application/json',
      Authorization: tokens?.accessToken ? `Bearer ${tokens?.accessToken}` : '',
  };
  ...

```

You can handle 401 status codes on API endpoints (excluding sign-in and sign-up) to redirect users or sign them out.

## API Reference

### Parameters

The `callApi` function accepts an options object with the following optional parameters:

| Name         | Type                           | Default     | Description                                                                                                                      |
| ------------ | ------------------------------ | ----------- | -------------------------------------------------------------------------------------------------------------------------------- |
| `url?`       | `string`                       | `undefined` | The endpoint to which the API request will be sent.                                                                              |
| `method?`    | `GET`, `POST`, `PUT`, `DELETE` | `'GET'`     | The HTTP method to use for the request.                                                                                          |
| `payload?`   | `any`                          | `undefined` | The data to be sent as the request body, typically for POST or PUT methods.                                                      |
| `query?`     | `Record<string, string>`       | `{}`        | Key-value pairs appended to the URL as query parameters.                                                                         |
| `multipart?` | `boolean`                      | `false`     | Whether the request should use multipart/form-data encoding.                                                                     |
| `refresh?`   | `boolean`                      | `false`     | Determines whether the request should use provided queries for request, especially good for requests associated with pagination. |
| `showError?` | `boolean`                      | `true`      | If true, automatically displays error messages (e.g., via toast, console.log).                                                   |

### Returns

The `useClient` hook returns an object with the following properties:

| Name         | Type                                               | Description                                                               |
| ------------ | -------------------------------------------------- | ------------------------------------------------------------------------- |
| `callApi`    | `(props: CallApiProps) => Promise<ClientResponse>` | A function that initiates the API request and returns a `ClientResponse`. |
| `cancel`     | `() => void`                                       | A function to cancel the request if it's still in progress.               |
| `loading`    | `boolean`                                          | Indicates whether an API request is currently in progress.                |
| `refreshing` | `boolean`                                          | Indicates whether a refresh request is currently in progress.             |
| `error`      | `string`                                           | An error message if the request fails.                                    |

---

The `ClientResponse` type represents the shape of the data returned by `callApi`.

| Name     | Type     | Description                                            |
| -------- | -------- | ------------------------------------------------------ |
| `status` | `number` | The HTTP status code returned by the API.              |
| `data`   | `any`    | The parsed JSON response returned by the API endpoint. |
